import{j as e,f as s,B as a,$ as i,a0 as r,t as n,x as o,h as t,L as c,k as l,m as d,K as u,a1 as x,N as m,O as h,Q as j,U as p}from"./chunk-CiyIQ443.js";import{r as g}from"./chunk-BP8el2rJ.js";import{a0 as v,o as f,a1 as y,S as b,W as S}from"./chunk-B1leO6dY.js";import{b as A,a as C,l as w}from"./index-COyCYR8d.js";import{m as k}from"./chunk-mLFKww0r.js";import"./chunk-BW7e_yWW.js";const I=()=>{const[I,D]=g.useState(!1),[F,L]=g.useState([]),[O,N]=g.useState(!1),{enqueueSnackbar:W}=A(),{logout:z}=C();return g.useEffect(()=>{const e=localStorage.getItem("2fa-enabled");null!==e&&D(JSON.parse(e));const s=[{id:"current",device:"Dispositivo Actual",browser:navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Firefox")?"Firefox":navigator.userAgent.includes("Safari")?"Safari":"Desconocido",os:navigator.platform.includes("Win")?"Windows":navigator.platform.includes("Mac")?"macOS":navigator.platform.includes("Linux")?"Linux":"Desconocido",location:"Buenos Aires, AR",active:!0,lastAccess:(new Date).toLocaleString(),current:!0},{id:"session-2",device:"iPhone 13",browser:"Safari",os:"iOS",location:"Córdoba, AR",active:!1,lastAccess:new Date(Date.now()-72e5).toLocaleString()},{id:"session-3",device:"Laptop",browser:"Firefox",os:"Linux",location:"Rosario, AR",active:!1,lastAccess:new Date(Date.now()-864e5).toLocaleString()}];L(s)},[]),e.jsxs(k.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx(s,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Seguridad"}),e.jsxs(a,{mt:2,display:"flex",flexDirection:"column",gap:3,children:[e.jsxs(a,{children:[e.jsx(i,{control:e.jsx(r,{checked:I,onChange:()=>{const e=!I;D(e),localStorage.setItem("2fa-enabled",JSON.stringify(e)),W("Autenticación en dos pasos "+(e?"activada":"desactivada"),{variant:e?"success":"info"}),w.info(`[INFO][Security] 2FA ${e?"habilitado":"deshabilitado"}.`)},inputProps:{"aria-label":"2FA Toggle"}}),label:e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(v,{fontSize:"small"}),"Autenticación en dos pasos (2FA)"]})}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{ml:5},children:I?"Tu cuenta está protegida con 2FA simulado":"Activa la verificación en dos pasos para mayor seguridad"}),I&&e.jsx(n,{severity:"info",sx:{mt:1,ml:5},children:e.jsx(s,{variant:"body2",children:"Modo simulado activado. En producción se conectaría con Google Authenticator o similar."})})]}),e.jsx(o,{}),e.jsxs(a,{children:[e.jsxs(a,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(s,{variant:"subtitle1",fontWeight:500,children:"Sesiones activas"}),e.jsx(t,{variant:"outlined",size:"small",color:"warning",startIcon:e.jsx(f,{}),onClick:()=>{N(!0)},children:"Cerrar todas"})]}),e.jsx(c,{dense:!0,disablePadding:!0,children:F.map(i=>e.jsxs(l,{sx:{mb:1,borderRadius:2,backgroundColor:i.current?"action.hover":"transparent",border:i.current?"1px solid":"none",borderColor:i.current?"primary.main":"transparent"},children:[e.jsx(d,{primary:e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[i.device,i.current&&e.jsx(u,{label:"Actual",size:"small",color:"primary"})]}),secondary:e.jsxs(a,{children:[e.jsxs(s,{variant:"body2",color:"text.secondary",children:[i.browser," • ",i.os," • ",i.location]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Último acceso: ",i.lastAccess]})]})}),e.jsx(x,{children:e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(y,{color:i.active?"success":"disabled",fontSize:"small"}),!i.current&&e.jsx(t,{size:"small",variant:"text",color:"error",onClick:()=>{return e=i.id,void(F.find(s=>s.id===e)?.current?z():(L(F.map(s=>s.id===e?{...s,active:!1,lastAccess:(new Date).toLocaleString()}:s)),W("Sesión cerrada correctamente",{variant:"success"}),w.info(`[INFO][Security] Sesión cerrada: ${e}`)));var e},children:"Cerrar"})]})})]},i.id))})]}),e.jsx(o,{}),e.jsxs(a,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:500,mb:1,children:"Puntuación de seguridad"}),e.jsxs(a,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(b,{color:"primary"}),e.jsxs(a,{children:[e.jsxs(s,{variant:"h6",color:"primary",children:[I?"85":"65","/100"]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:I?"Buena seguridad":"Seguridad básica"})]})]}),!I&&e.jsx(n,{severity:"warning",sx:{mt:1},children:e.jsx(s,{variant:"body2",children:"Activa la autenticación en dos pasos para mejorar tu puntuación de seguridad."})})]})]}),e.jsxs(m,{open:O,onClose:()=>N(!1),children:[e.jsx(h,{children:e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(S,{color:"warning"}),"Cerrar todas las sesiones"]})}),e.jsx(j,{children:e.jsx(s,{children:"¿Estás seguro que quieres cerrar todas las sesiones activas? Tendrás que volver a iniciar sesión en todos los dispositivos."})}),e.jsxs(p,{children:[e.jsx(t,{onClick:()=>N(!1),children:"Cancelar"}),e.jsx(t,{onClick:()=>{L(F.map(e=>({...e,active:!!e.current}))),N(!1),W("Sesiones cerradas en todos los dispositivos",{variant:"success"}),w.info("[INFO][Security] Sesiones cerradas globalmente.")},color:"warning",variant:"contained",children:"Cerrar todas"})]})]})]})};export{I as default};
