import{w as e,j as r,k as t,r as o,D as a,E as i,H as s,K as n,G as l,O as p,P as d}from"./index-CAkMPucN.js";import{T as m}from"./TextField-I4fxrPOr.js";import{I as c}from"./InputAdornment-BdqI-dld.js";import{I as x}from"./IconButton-Dgo8PozH.js";import{V as u,a as g}from"./VisibilityOff-DB95BkTj.js";import{I as f}from"./Info-pN-e-TEs.js";import{W as b}from"./Warning-DAbE4CwE.js";import{C as h}from"./CheckCircle-C0pduSvW.js";import{S as j}from"./Skeleton-C_0gDa2x.js";import{a as v}from"./axiosInstance-fZgyMyda.js";import{E as S}from"./Email-BYk6gf83.js";import{A as k,P as w}from"./PageContainer-MJ0FUNQ2.js";import{S as y}from"./Stack-D4WZtwBi.js";import{A as C}from"./Alert-BAPMIHz2.js";import{B as F}from"./Button-BXsVoJ5T.js";import"./Select-BRxYfMSs.js";import"./useFormControl-CyOgmSPV.js";import"./List-CGGHAjoq.js";import"./isHostComponent-DS5evmks.js";import"./Paper-DiZFp9lZ.js";import"./mergeSlotProps-CeDtsuiT.js";import"./index-B7hBRbuO.js";import"./useThemeProps-geqIm1RD.js";import"./Container-jvdD_H6w.js";const _=e(r.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),M=e(r.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})),P=({enableVisibilityToggle:e=!1,validationStatus:n="default",isLoadingValidation:l=!1,tooltipMessage:p,maxLength:d,...j})=>{const v=t(),[S,k]=o.useState(!1),[w,y]=o.useState(!1),C=()=>{switch(n){case"success":return v.palette.success.main;case"error":return v.palette.error.main;case"warning":return v.palette.warning.main;default:return v.palette.primary.main}},F=(e,r=.3)=>`0 0 0 3px ${i(e,r)}`;return r.jsxs(a,{sx:{position:"relative",mb:2},children:[r.jsx(m,{...j,variant:"outlined",type:e&&"password"===j.type?S?"text":"password":j.type,InputProps:{...j.InputProps,endAdornment:r.jsxs(c,{position:"end",children:[(()=>{if(l)return r.jsx(a,{sx:{width:20,height:20,borderRadius:"50%",border:`2px solid ${v.palette.primary.main}`,borderTopColor:"transparent",animation:"spin 1s linear infinite"}});switch(n){case"success":return r.jsx(h,{sx:{color:v.palette.success.main,fontSize:20}});case"error":return r.jsx(_,{sx:{color:v.palette.error.main,fontSize:20}});case"warning":return r.jsx(b,{sx:{color:v.palette.warning.main,fontSize:20}});default:return null}})(),e&&"password"===j.type&&r.jsx(x,{onClick:()=>{k(!S)},edge:"end",sx:{ml:1},children:S?r.jsx(u,{}):r.jsx(g,{})}),p&&r.jsx(s,{title:p,open:w,onClose:()=>y(!1),placement:"top",children:r.jsx(x,{size:"small",onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),sx:{ml:1},children:r.jsx(f,{sx:{fontSize:18,color:v.palette.text.secondary}})})})]})},sx:{"& .MuiFormControl-root":{marginBottom:0},"& .MuiInputLabel-root":{color:"dark"===v.palette.mode?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.8)",fontWeight:500,fontSize:"0.875rem",transform:"translate(14px, 16px) scale(1)","&.Mui-focused":{color:C(),transform:"translate(14px, -9px) scale(0.75)"},"&.Mui-error":{color:v.palette.error.main},"&.MuiInputLabel-shrink":{transform:"translate(14px, -9px) scale(0.75)"}},"& .MuiOutlinedInput-root":{backgroundColor:"dark"===v.palette.mode?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)",border:`1px solid ${i(v.palette.primary.main,.2)}`,borderRadius:"12px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"dark"===v.palette.mode?"inset 2px 2px 4px rgba(0, 0, 0, 0.3), inset -2px -2px 4px rgba(255, 255, 255, 0.05)":"inset 2px 2px 4px rgba(0, 0, 0, 0.1), inset -2px -2px 4px rgba(255, 255, 255, 0.8)",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",paddingRight:"16px","&:hover":{borderColor:i(v.palette.primary.main,.4),backgroundColor:"dark"===v.palette.mode?"rgba(255, 255, 255, 0.08)":"rgba(255, 255, 255, 0.9)",boxShadow:"dark"===v.palette.mode?"inset 2px 2px 4px rgba(0, 0, 0, 0.4), inset -2px -2px 4px rgba(255, 255, 255, 0.08), 0 0 0 2px rgba(99, 102, 241, 0.1)":"inset 2px 2px 4px rgba(0, 0, 0, 0.15), inset -2px -2px 4px rgba(255, 255, 255, 0.9), 0 0 0 2px rgba(99, 102, 241, 0.08)"},"&.Mui-focused":{borderColor:C(),backgroundColor:"dark"===v.palette.mode?"rgba(255, 255, 255, 0.1)":"rgba(255, 255, 255, 1)",boxShadow:"dark"===v.palette.mode?`inset 1px 1px 2px rgba(0, 0, 0, 0.2), inset -1px -1px 2px rgba(255, 255, 255, 0.1), ${F(C(),.3)}`:`inset 1px 1px 2px rgba(0, 0, 0, 0.1), inset -1px -1px 2px rgba(255, 255, 255, 1), ${F(C(),.2)}`,transform:"translateY(-1px)"},"&.Mui-error":{borderColor:v.palette.error.main,boxShadow:"dark"===v.palette.mode?`inset 1px 1px 2px rgba(0, 0, 0, 0.2), inset -1px -1px 2px rgba(255, 255, 255, 0.1), ${F(v.palette.error.main,.3)}`:`inset 1px 1px 2px rgba(0, 0, 0, 0.1), inset -1px -1px 2px rgba(255, 255, 255, 1), ${F(v.palette.error.main,.2)}`},"& input":{color:"dark"===v.palette.mode?"#F8FAFC":"#1F2937",fontSize:"1rem",fontWeight:500,padding:"8px 0","&::placeholder":{color:"dark"===v.palette.mode?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)",opacity:1}},"& textarea":{color:"dark"===v.palette.mode?"#F8FAFC":"#1F2937",fontSize:"1rem",fontWeight:500,padding:"8px 0","&::placeholder":{color:"dark"===v.palette.mode?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)",opacity:1}},"& .MuiSelect-select":{color:"dark"===v.palette.mode?"#F8FAFC":"#1F2937",fontSize:"1rem",fontWeight:500,padding:"8px 0"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"& .MuiInputAdornment-root":{marginLeft:1,"& .MuiIconButton-root":{color:v.palette.text.secondary,"&:hover":{color:C(),backgroundColor:i(C(),.1)}}}},"& .MuiFormHelperText-root":{color:"dark"===v.palette.mode?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",fontSize:"0.875rem",fontWeight:400,marginTop:"8px",marginLeft:"16px","&.Mui-error":{color:v.palette.error.main}}}}),d&&r.jsxs(a,{sx:{position:"absolute",bottom:-24,right:0,fontSize:"0.75rem",color:v.palette.text.secondary,backgroundColor:"dark"===v.palette.mode?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.9)",padding:"2px 6px",borderRadius:"4px",backdropFilter:"blur(4px)",border:`1px solid ${i(v.palette.text.secondary,.2)}`},children:[j.value?.toString().length||0,"/",d]})]})},z=({variant:e,width:s,height:n,animation:l="wave",sx:p={},count:d=1,ariaLabel:m="Cargando..."})=>{const c=t();o.useEffect(()=>{},[e,s,n,l,d]);const x=Math.max(1,d),u=i(c.palette?.custom?.neumoDarkShadow||"#000",.4),g=i(c.palette?.custom?.neumoLightShadow||"#fff",.5),f={backgroundColor:c.palette.custom?.neumoSurface||c.palette.background.paper,borderRadius:"circular"===e?"50%":"12px",boxShadow:`2px 2px 5px ${u}, -2px -2px 5px ${g}`,transition:"all 0.3s ease-in-out","&::after":{background:`linear-gradient(90deg, transparent, ${i(c.palette.text.primary,.1)}, transparent)`},...p},b=Array.from({length:x}).map((t,o)=>r.jsx(j,{variant:e,width:s,height:n,animation:l,sx:f,role:"status","aria-label":m},o));return x>1?r.jsx(a,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:b}):b[0]},I=()=>{const e=t(),m="dark"===e.palette.mode,x=n(m),[u,g]=o.useState(""),[f,b]=o.useState(!1),[j,_]=o.useState(null),[I,E]=o.useState(null),[$,L]=o.useState(!1),[A,R]=o.useState(!1),[T,B]=o.useState(!0);o.useEffect(()=>()=>{},[]),o.useEffect(()=>{const e=setTimeout(()=>{B(!1)},1e3);return()=>clearTimeout(e)},[]);const O=e=>({"forgot.email_required":"El email es obligatorio.","forgot.email_invalid":"El formato del email no es válido.","forgot.email_valid":"Email válido","forgot.email_invalid_tooltip":"Email inválido","forgot.send_link":"Enviar Enlace de Restablecimiento","forgot.back_to_login":"Volver al login","forgot.success":"¡Listo! Si el correo ingresado está registrado, recibirás instrucciones para recuperar tu contraseña en breve.","forgot.general_error":"Por favor, corrige el email antes de continuar.","forgot.title":"Recuperar Contraseña","forgot.email_label":"Correo electrónico","forgot.email_placeholder":"Ingresa tu correo electrónico registrado"}[e]||e),W=e=>e.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?null:O("forgot.email_invalid"):O("forgot.email_required"),D=async e=>{e&&e.preventDefault(),b(!0),E(null),L(!1);const r=W(u);if(r)return _(r),E(O("forgot.general_error")),void document.getElementById("forgot-email")?.focus();R(!0),d.info("[INFO][PROD][ForgotPasswordPage] Solicitud de restablecimiento iniciada.");try{const e=await v.post("/auth/forgot-password",{email:u});e?.data?.message?(L(!0),d.info("[INFO][PROD][ForgotPasswordPage] Enlace de recuperación enviado.")):(E("No se recibió una respuesta válida del servidor al solicitar el restablecimiento."),d.error("[ERROR][PROD][ForgotPasswordPage] Fallo de respuesta de servidor en recuperación de contraseña."))}catch(t){const e=t,r=e?.response?.data?.detail||"Error al enviar el email de recuperación";E(r),d.error("[ForgotPassword] Error HTTP:",r)}finally{R(!1)}},V=A||f&&!!j;return r.jsx(k,{children:r.jsx(w,{maxWidth:480,children:T?r.jsxs(y,{spacing:3,children:[r.jsx(z,{variant:"rectangular",height:56}),r.jsx(z,{variant:"rectangular",height:48,width:"60%",sx:{mx:"auto"}}),r.jsx(z,{variant:"rectangular",height:36,width:"40%",sx:{mx:"auto"}})]}):r.jsxs(a,{sx:{width:"100%",backgroundColor:x.surface.primary,backdropFilter:"blur(15px) saturate(180%)",borderRadius:4,boxShadow:`0 8px 30px ${i(e.palette.custom.neumoDarkShadow,"dark"===e.palette.mode?.7:.3)}`,border:`1px solid ${e.palette.custom.glassBorder}`,transition:"all 0.3s ease-in-out",p:{xs:3,sm:4},position:"relative",zIndex:1},children:[r.jsx(l,{variant:"h5",gutterBottom:!0,sx:{textAlign:"center",color:e.palette.primary.main,mb:3,fontWeight:600},children:O("forgot.title")}),r.jsxs("form",{onSubmit:D,onKeyDown:e=>{"Enter"===e.key&&D(e)},children:[r.jsx(P,{id:"forgot-email",label:O("forgot.email_label"),name:"email",fullWidth:!0,required:!0,value:u,onChange:e=>{const r=e.target.value;g(r);const t=W(r);_(t),I&&!t&&E(null)},onBlur:()=>{b(!0);const e=W(u);_(e)},error:f&&!!j,helperText:f&&j||" ",validationStatus:u?j?"error":"success":"default",tooltipMessage:O("forgot.email_placeholder"),inputProps:{"aria-label":O("forgot.email_label")},autoComplete:"email",inputMode:"email",maxLength:64,sx:{mb:2,transition:"box-shadow 0.2s",boxShadow:f&&j?`0 0 0 2px ${e.palette.error.main}`:f&&!j&&u?`0 0 0 2px ${e.palette.success.main}`:void 0},InputProps:{startAdornment:r.jsx(c,{position:"start",children:r.jsx(s,{title:O("forgot.email_label"),arrow:!0,children:r.jsx(S,{sx:{color:e.palette.text.secondary}})})}),endAdornment:f&&u?j?r.jsx(c,{position:"end",children:r.jsx(s,{title:O("forgot.email_invalid_tooltip"),arrow:!0,children:r.jsx(M,{color:"error"})})}):r.jsx(c,{position:"end",children:r.jsx(s,{title:O("forgot.email_valid"),arrow:!0,children:r.jsx(h,{color:"success"})})}):null,"aria-invalid":Boolean(f&&j),"aria-describedby":"forgot-email-helper"},FormHelperTextProps:{id:"forgot-email-helper","aria-live":"polite"}}),I&&r.jsx(C,{severity:"error",sx:{mt:2},children:I}),$&&r.jsx(C,{severity:"success",sx:{mt:2},children:"¡Listo! Si el correo ingresado está registrado, recibirás instrucciones para recuperar tu contraseña en breve."}),r.jsx(F,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{mt:3,px:{xs:4,sm:6},py:{xs:1.5,sm:2},fontSize:{xs:"1rem",sm:"1.1rem"},boxShadow:"0 2px 8px rgba(0,0,0,0.08)",transition:"background 0.2s, transform 0.1s","&:hover":{background:e.palette.primary.dark,transform:"scale(1.02)"}},disabled:V,"aria-label":O("forgot.send_link"),children:A?r.jsx(p,{size:24,sx:{color:"white"}}):O("forgot.send_link")}),r.jsx(F,{fullWidth:!0,variant:"text",onClick:()=>{window.location.href="/login"},sx:{mt:1.5,fontSize:"0.9rem",color:e.palette.text.secondary,"&:hover":{color:e.palette.primary.main,textDecoration:"underline",transform:"translateY(-1px)"},transition:"transform 0.2s ease-in-out"},"aria-label":O("forgot.back_to_login"),children:"Volver al login"})]})]})})})};export{I as default};
