import{w as s,j as e,r as a,S as i,Q as r,F as o,G as t,D as n,P as c}from"./index-CAkMPucN.js";import{D as l}from"./Devices-mYuHexjD.js";import{L as d}from"./Logout-Cd-bFscF.js";import{S as m}from"./Security-C-Vs0VCx.js";import{W as u}from"./Warning-DAbE4CwE.js";import{F as x,S as p}from"./Switch-DA4cNyCz.js";import{A as j}from"./Alert-BAPMIHz2.js";import{D as g}from"./Divider-BO9i9GCW.js";import{B as h}from"./Button-BXsVoJ5T.js";import{a as v}from"./List-CGGHAjoq.js";import{L as f,a as S,b as y}from"./ListItemText-DdjEFqDJ.js";import{C as b}from"./Chip-BnihpXua.js";import{D as A,a as C,b as w,c as D}from"./DialogTitle-ByEE1fuE.js";import"./useFormControl-CyOgmSPV.js";import"./IconButton-Dgo8PozH.js";import"./Paper-DiZFp9lZ.js";import"./dividerClasses-DOgubGFh.js";import"./isHostComponent-DS5evmks.js";import"./listItemTextClasses-jva935Ny.js";const I=s(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),F=()=>{const[s,F]=a.useState(!1),[L,k]=a.useState([]),[W,z]=a.useState(!1),{enqueueSnackbar:O}=i(),{logout:T}=r();return a.useEffect(()=>{const s=localStorage.getItem("2fa-enabled");null!==s&&F(JSON.parse(s));const e=[{id:"current",device:"Dispositivo Actual",browser:navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Firefox")?"Firefox":navigator.userAgent.includes("Safari")?"Safari":"Desconocido",os:navigator.platform.includes("Win")?"Windows":navigator.platform.includes("Mac")?"macOS":navigator.platform.includes("Linux")?"Linux":"Desconocido",location:"Buenos Aires, AR",active:!0,lastAccess:(new Date).toLocaleString(),current:!0},{id:"session-2",device:"iPhone 13",browser:"Safari",os:"iOS",location:"Córdoba, AR",active:!1,lastAccess:new Date(Date.now()-72e5).toLocaleString()},{id:"session-3",device:"Laptop",browser:"Firefox",os:"Linux",location:"Rosario, AR",active:!1,lastAccess:new Date(Date.now()-864e5).toLocaleString()}];k(e)},[]),e.jsxs(o.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx(t,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Seguridad"}),e.jsxs(n,{mt:2,display:"flex",flexDirection:"column",gap:3,children:[e.jsxs(n,{children:[e.jsx(x,{control:e.jsx(p,{checked:s,onChange:()=>{const e=!s;F(e),localStorage.setItem("2fa-enabled",JSON.stringify(e)),O("Autenticación en dos pasos "+(e?"activada":"desactivada"),{variant:e?"success":"info"}),c.info(`[INFO][Security] 2FA ${e?"habilitado":"deshabilitado"}.`)},inputProps:{"aria-label":"2FA Toggle"}}),label:e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(I,{fontSize:"small"}),"Autenticación en dos pasos (2FA)"]})}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{ml:5},children:s?"Tu cuenta está protegida con 2FA simulado":"Activa la verificación en dos pasos para mayor seguridad"}),s&&e.jsx(j,{severity:"info",sx:{mt:1,ml:5},children:e.jsx(t,{variant:"body2",children:"Modo simulado activado. En producción se conectaría con Google Authenticator o similar."})})]}),e.jsx(g,{}),e.jsxs(n,{children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(t,{variant:"subtitle1",fontWeight:500,children:"Sesiones activas"}),e.jsx(h,{variant:"outlined",size:"small",color:"warning",startIcon:e.jsx(d,{}),onClick:()=>{z(!0)},children:"Cerrar todas"})]}),e.jsx(v,{dense:!0,disablePadding:!0,children:L.map(s=>e.jsxs(f,{sx:{mb:1,borderRadius:2,backgroundColor:s.current?"action.hover":"transparent",border:s.current?"1px solid":"none",borderColor:s.current?"primary.main":"transparent"},children:[e.jsx(S,{primary:e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[s.device,s.current&&e.jsx(b,{label:"Actual",size:"small",color:"primary"})]}),secondary:e.jsxs(n,{children:[e.jsxs(t,{variant:"body2",color:"text.secondary",children:[s.browser," • ",s.os," • ",s.location]}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Último acceso: ",s.lastAccess]})]})}),e.jsx(y,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(l,{color:s.active?"success":"disabled",fontSize:"small"}),!s.current&&e.jsx(h,{size:"small",variant:"text",color:"error",onClick:()=>{return e=s.id,void(L.find(s=>s.id===e)?.current?T():(k(L.map(s=>s.id===e?{...s,active:!1,lastAccess:(new Date).toLocaleString()}:s)),O("Sesión cerrada correctamente",{variant:"success"}),c.info(`[INFO][Security] Sesión cerrada: ${e}`)));var e},children:"Cerrar"})]})})]},s.id))})]}),e.jsx(g,{}),e.jsxs(n,{children:[e.jsx(t,{variant:"subtitle1",fontWeight:500,mb:1,children:"Puntuación de seguridad"}),e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(m,{color:"primary"}),e.jsxs(n,{children:[e.jsxs(t,{variant:"h6",color:"primary",children:[s?"85":"65","/100"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:s?"Buena seguridad":"Seguridad básica"})]})]}),!s&&e.jsx(j,{severity:"warning",sx:{mt:1},children:e.jsx(t,{variant:"body2",children:"Activa la autenticación en dos pasos para mejorar tu puntuación de seguridad."})})]})]}),e.jsxs(A,{open:W,onClose:()=>z(!1),children:[e.jsx(C,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(u,{color:"warning"}),"Cerrar todas las sesiones"]})}),e.jsx(w,{children:e.jsx(t,{children:"¿Estás seguro que quieres cerrar todas las sesiones activas? Tendrás que volver a iniciar sesión en todos los dispositivos."})}),e.jsxs(D,{children:[e.jsx(h,{onClick:()=>z(!1),children:"Cancelar"}),e.jsx(h,{onClick:()=>{k(L.map(s=>({...s,active:!!s.current}))),z(!1),O("Sesiones cerradas en todos los dispositivos",{variant:"success"}),c.info("[INFO][Security] Sesiones cerradas globalmente.")},color:"warning",variant:"contained",children:"Cerrar todas"})]})]})]})};export{F as default};
